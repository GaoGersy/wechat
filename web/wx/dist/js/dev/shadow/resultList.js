require(["../../requireconfig"],function(){require(["zepto","vue","vue-resource","layer","global","dropload"],function(e,t,a,o,d,i){({init:function(){var e=this;t.use(a),e.index=new t({el:"#searchResult",data:{beginTime:d.getUrl("beginTime"),endTime:d.getUrl("endTime"),bounds:d.getUrl("bounds"),cloud:d.getUrl("cloud"),time:"",satelliList:[],satelliteId:"",src:"",type:"",iswork:!1,isnull:!1,isloading:!1,gfName:"",sensorId:""},filters:{cloudFormat:function(e){return e+"%"}},methods:{getData:function(e,t){var a=this;a.isloading=!0;var o=d.baseUrlgch+"getImageList";a.$http.post(o,e).then(function(o){if(200!=o.data.code)return a.isloading=!1,a.iswork=!0,!1;if(200==o.data.code){a.iswork=!1;var i=o.data.data.data;0!=i.length?($(".content").show(),a.isnull=!1,$.each(i,function(e,t){"GF1"==t.satelliteId?t.gfName="高分一号":"GF2"==t.satelliteId?t.gfName="高分二号":"GF3"==t.satelliteId?t.gfName="高分三号":"GF4"==t.satelliteId&&(t.gfName="高分四号");var o=d.getPx(t.satelliteId,t.sensorId);t.sensorId=o.resolving,t.sceneDate=d.dateFormat(t.sceneDate,"yyyy-MM-dd"),t.src=d.imgUrl+"getThumb?metaId="+t.dataId,t.cloudPercent=t.cloudPercent+"%",a.satelliList.push(t)}),o.data.data.pageCount>o.data.data.currentPage?(t.unlock(),t.noData(!1)):(console.log("无数据"),t.lock(),t.noData()),e.currentPage++,setTimeout(function(){t.resetload()},1e3)):setTimeout(function(){a.isnull=!0},1e3)}else d.popupMobile.msg("请求失败"),t.resetload();setTimeout(function(){a.isloading=!1},1e3)})},getDetail:function(e){var t,a=e.satelliteId;"高分一号"==a?t=1:"高分二号"==a?t=2:"高分三号"==a?t=3:"高分四号"==a&&(t=4),window.location.href="./detail.html?dataId="+e.dataId+"&satelliteType="+t}},mounted:function(){var e=this,t=d.getUrl("data"),t=$.parseJSON(t);$(".content").dropload({scrollArea:window,domDown:{domClass:"dropload-down",domRefresh:'<div class="dropload-refresh">↑上拉加载更多</div>',domLoad:'<div class="dropload-load"><span class="loading"></span>加载中...</div>',domNoData:'<div class="dropload-noData">已经到底了！</div>'},loadDownFn:function(a){e.getData(t,a)}})}}),t.filter("cloudFormat",function(e,t){return e+t})}}).init()})});
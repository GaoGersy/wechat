require(["../../requireconfig"],function(){require(["zepto","vue","vue-resource","layer","global","dropload"],function(t,e,a,d,o,i){({init:function(){var t=this;e.use(a),t.index=new e({el:"#order",data:{orderId:o.getUrl("orderId"),disstate:o.getUrl("disstate"),applyState:"",childorderList:[],orderStatu:"",orderdate:"",satelliteId:"",orderId:o.getUrl("orderId"),dataapplication:o.getUrl("dataapplication"),currentPage:1,iswork:!1,isnull:!1,isloading:!1},methods:{getDetail:function(t){var e=this;window.location.href="./detail.html?dataId="+t.productId+"&disstate="+e.disstate},getChildOrder:function(t){var e=this;e.isloading=!0;var a={orderId:e.orderId,currentPage:e.currentPage,pageSize:10},d=o.baseUrlgch+"order/getChildOrderByOrderId";e.$http.post(d,a).then(function(a){if(200!=a.data.code)return e.isloading=!1,e.iswork=!0,!1;var d=a.data.data.list;if(0!=d.length){$(".order-list").show(),e.isnull=!1,setTimeout(function(){$(".dropload-down").show()},1e3),$.each(d,function(t,a){a.backTime=o.dateFormat(a.backTime,"yyyy-MM-dd"),a.src=o.imgUrl+"getThumb?metaId="+a.productId,a.disstate=e.disstate,0==e.disstate?e.applyState="未审核":1==e.disstate?e.applyState="审核通过":e.applyState="未通过","GF1"==a.satelliteId?a.satelliteId="高分一号":"GF2"==a.satelliteId?a.satelliteId="高分二号":"GF3"==a.satelliteId?a.satelliteId="高分三号":"GF4"==a.satelliteId&&(a.satelliteId="高分四号"),e.childorderList.push(a)});var i=a.data.data.pageCount,r=a.data.data.currentPage;console.log("pageCount:"+i),i>r?(t.unlock(),t.noData(!1)):(t.lock(),t.noData()),e.currentPage++,setTimeout(function(){t.resetload()},1e3)}else setTimeout(function(){e.isnull=!0},1e3)},function(){o.popupMobile.msg("请求失败"),t.resetload()}),setTimeout(function(){e.isloading=!1},1e3)}},mounted:function(){var t=this;t.token=localStorage.getItem("token"),$(".content").dropload({scrollArea:window,domDown:{domClass:"dropload-down",domRefresh:'<div class="dropload-refresh">↑上拉加载更多</div>',domLoad:'<div class="dropload-load"><span class="loading"></span>加载中...</div>',domNoData:'<div class="dropload-noData">已经到底了！</div>'},loadDownFn:function(e){t.getChildOrder(e)}})}})}}).init()})});